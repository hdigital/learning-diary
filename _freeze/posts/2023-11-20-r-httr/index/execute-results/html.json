{
  "hash": "045417ba80687ad69c673f705d38df72",
  "result": {
    "markdown": "---\ndate: \"2023-11-20\"\nimage: httr2-logo.png\ncategories: [R, API]\ntitle: API requests with httr2\nformat:\n  html:\n    toc: true\n---\n\n\n[httr2 1.0](https://www.tidyverse.org/blog/2023/11/httr2-1-0-0/) was recently released. I used it earlier this month in my API explorations to understand what the Python [requests](https://github.com/psf/requests) equivalent is in R. Python and _requests_ are so convenient that I had not used R yet to access an API.\n\nI became aware of [Semantic Scholar](https://www.semanticscholar.org/author/Holger-D%C3%B6ring/51362391), a database of scientific literature, with a nice [API](https://api.semanticscholar.org/api-docs/).\n\nSo here is an exploration of my Semantic Scholar records (ID 51362391) in R with httr2.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(tidyverse)\nlibrary(httr2)\nlibrary(jsonlite)\n```\n:::\n\n\n## API request\n\n[API · Fetch paper and author data](https://api.semanticscholar.org/api-docs/#tag/Author-Data/operation/get_graph_get_author)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nauthor_id <- 51362391\n\nurl <-\n  str_glue(\n    \"https://api.semanticscholar.org/graph/v1/author/{author_id}\",\n    \"?fields=aliases,name,papers,papers.year,papers.title,papers.citationCount,papers.authors\"\n  )\n\nresp <-\n  request(url) |>\n  req_perform()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndt <-\n  resp_body_string(resp) |>\n  fromJSON()\n\nprint(dt[[\"name\"]])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Holger Döring\"\n```\n:::\n:::\n\n\n\n## Publications\n\n\n::: {.cell}\n\n```{.r .cell-code}\npapers <-\n  dt[[\"papers\"]] |>\n  mutate(\n    id_short = str_sub(paperId, 1, 5),\n    title_short = str_sub(title, 1, 30),\n    authors_n = map_int(authors, \\(.x) nrow(.x))\n    )\n```\n:::\n\n\nNumber of publications at Semantic Scholar\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(papers)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 24\n```\n:::\n:::\n\n\nPublications\n\n\n::: {.cell}\n\n```{.r .cell-code}\npapers |>\n  select(id_short, year, `cita.`=citationCount, `auth.`=authors_n, title_short)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|id_short | year| cita.| auth.|title_short                    |\n|:--------|----:|-----:|-----:|:------------------------------|\n|a9408    | 2022|     0|     1|Formal binary logic, tidal for |\n|c229b    | 2022|     0|     1|Beyond the light-barrier -fast |\n|e3034    | 2022|     0|     1|Occams Razor-No Dark Matter in |\n|37135    | 2021|     0|     1|Lorentzian SRT-Transformation  |\n|84d1f    | 2021|     1|     3|Germany: From Stable Coalition |\n|8bd34    | 2020|     6|     3|Institutional constraints on c |\n|1b9e9    | 2019|     8|     2|Party Positions from Wikipedia |\n|e9e28    | 2019|    41|     2|Party Facts: A database of pol |\n|f93aa    | 2019|     0|     1|Gathering and Managing Data on |\n|69fe5    | 2016|     4|     1|Mapping established democracie |\n|4175b    | 2015|    24|     2|Is Proportional Representation |\n|85957    | 2015|     0|     3|How do European democracies co |\n|a9372    | 2015|    28|     2|Revisiting the left cabinet sh |\n|34e81    | 2014|     1|     2|Jean-Claude Juncker’s new Euro |\n|1273f    | 2013|    61|     2|Who Gets into Government? Coal |\n|31eff    | 2013|    31|     1|The collective action of data  |\n|c01fd    | 2012|     2|     3|Ministerial Careers and 'The M |\n|c4f64    | 2011|     0|     2|Why are States with Pr More Re |\n|e3cbe    | 2010|     0|     1|Collaborative Data Collection  |\n|f5948    | 2009|     0|     1|Political representation in Eu |\n|2ebbf    | 2008|    35|     2|Electoral and Mechanical Cause |\n|ec86a    | 2008|     0|     1|Evaluating Scripting Languages |\n|14ab0    | 2007|    68|     1|The Composition of the College |\n|9674d    | 2006|     3|     2|Divided Government European St |\n\n</div>\n:::\n:::\n\n\n## Authors\n\nAuthors by paper\n\n\n::: {.cell}\n\n```{.r .cell-code}\nauthors <-\n  papers |>\n  select(id_short, year, authors) |>\n  unnest(authors)\n\nauthors\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|id_short | year|authorId   |name            |\n|:--------|----:|:----------|:---------------|\n|a9408    | 2022|51362391   |Holger Döring   |\n|c229b    | 2022|51362391   |Holger Döring   |\n|e3034    | 2022|51362391   |Holger Döring   |\n|37135    | 2021|51362391   |Holger Döring   |\n|84d1f    | 2021|94263396   |M. Debus        |\n|84d1f    | 2021|51362391   |Holger Döring   |\n|84d1f    | 2021|143708020  |Alejandro Ecker |\n|8bd34    | 2020|119358998  |Maria Thürk     |\n|8bd34    | 2020|145985059  |Johan Hellström |\n|8bd34    | 2020|51362391   |Holger Döring   |\n|1b9e9    | 2019|145315358  |M. Herrmann     |\n|1b9e9    | 2019|51362391   |Holger Döring   |\n|e9e28    | 2019|51362391   |Holger Döring   |\n|e9e28    | 2019|1685592    |Sven Regel      |\n|f93aa    | 2019|51362391   |Holger Döring   |\n|69fe5    | 2016|51362391   |Holger Döring   |\n|4175b    | 2015|51362391   |Holger Döring   |\n|4175b    | 2015|2072035416 |P. Manow        |\n|85957    | 2015|144008442  |Jonathan Bright |\n|85957    | 2015|51362391   |Holger Döring   |\n|85957    | 2015|145474393  |Conor Little    |\n|a9372    | 2015|51362391   |Holger Döring   |\n|a9372    | 2015|115016266  |Hanna Schwander |\n|34e81    | 2014|82184129   |A. Wonka        |\n|34e81    | 2014|51362391   |Holger Döring   |\n|1273f    | 2013|51362391   |Holger Döring   |\n|1273f    | 2013|145985059  |Johan Hellström |\n|31eff    | 2013|51362391   |Holger Döring   |\n|c01fd    | 2012|144008442  |Jonathan Bright |\n|c01fd    | 2012|51362391   |Holger Döring   |\n|c01fd    | 2012|145474393  |Conor Little    |\n|c4f64    | 2011|2072035416 |P. Manow        |\n|c4f64    | 2011|51362391   |Holger Döring   |\n|e3cbe    | 2010|51362391   |Holger Döring   |\n|f5948    | 2009|51362391   |Holger Döring   |\n|2ebbf    | 2008|2072035416 |P. Manow        |\n|2ebbf    | 2008|51362391   |Holger Döring   |\n|ec86a    | 2008|51362391   |Holger Döring   |\n|14ab0    | 2007|51362391   |Holger Döring   |\n|9674d    | 2006|2072035416 |P. Manow        |\n|9674d    | 2006|51362391   |Holger Döring   |\n\n</div>\n:::\n:::\n\n\n\n---\n\n![](httr2-logo.png)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}