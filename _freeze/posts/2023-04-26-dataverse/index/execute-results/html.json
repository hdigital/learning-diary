{
  "hash": "5a72e9dc19e53de87b9c06ce50b776ff",
  "result": {
    "engine": "knitr",
    "markdown": "---\ndate: \"2023-04-27\"\nimage: dataverse-url.png\ncategories: [R]\n---\n\n\n# Dataverse URLs\n\nI followed a talk on electoral politics in Honduras. The presenter referred to the very stable two party system in Honduras. That made me interested to look at election results in Honduras. A quick analysis with [Elections Global](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/OGOURC) gave a good overview -- see below.\n\nThe technical point is that I wanted to access the original data file at the [Harvard Dataverse](https://dataverse.harvard.edu/).\n\nData uploaded to the Dataverse is imported and a tab separated data version of the imported data is provided by the Dataverse. This is not the original file and may include some import errors. I ran into the issue in previous work so that I have worked with the original data file from the Dataverse. However, there is no direct link available at the Dataverse page of a data file.\n\nHere is an example for the Elections Global data used in the snippet -- see page screenshot below.\n\n[doi:10.7910/DVN/OGOURC/YK9DOZ&version=2.0](https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/OGOURC/YK9DOZ&version=2.0)\n\nSo I tried to find the permanent link to the original data file.\n\nFirst, I checked the documentation of the Dataverse API but could not find a way to access an original data file through API parameters. Only the imported file is available through the API.\n\nSecond, I got the link by checking the request from clicking on the respective dynamic button at the Dataverse page with the browser developer tools. However, this url does not seem to have a structure that is related to the identifier of the dataset. Getting the url of the original data file this way is cumbersome.\n\nFor now, I will start to using the imported data version with the provided url for data files from the Dataverse.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(conflicted)\nlibrary(tidyverse)\nconflicts_prefer(dplyr::filter)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nif (FALSE) {\n  url_csv <- \"https://dataverse.harvard.edu/api/access/datafile/3754546?format=original\"\n  elec_raw <- read_csv(url_csv)\n}\n\nurl <- \"https://dataverse.harvard.edu/api/access/datafile/:persistentId?persistentId=doi:10.7910/DVN/OGOURC/YK9DOZ\"\n\nif (!exists(\"elec_raw\")) {\n  elec_raw <- read_tsv(url)\n}\n\n# glimpse(elec_raw)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nhnd <-\n  elec_raw |>\n  filter(country == \"HND\") |>\n  mutate(\n    year = as.integer(substr(election_date, 1, 4)),\n    seats_share = 100 * seats / seats_total\n  )\n\nhnd |>\n  summarise(\n    n = n(),\n    share_mean = mean(seats_share, na.rm = TRUE) |> round(1),\n    share_max = max(seats_share, na.rm = TRUE) |> round(1),\n    year_first = min(year, na.rm = TRUE),\n    year_last = max(year, na.rm = TRUE),\n    .by = party\n  ) |>\n  select(party, n, n:year_last) |>\n  arrange(desc(n), desc(share_mean))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|party                                       |  n| share_mean| share_max| year_first| year_last|\n|:-------------------------------------------|--:|----------:|---------:|----------:|---------:|\n|National Party of Honduras                  | 25|       60.8|     100.0|       1923|      2013|\n|Liberal Party of Honduras                   | 20|       40.3|      62.1|       1923|      2013|\n|other (other-script)                        | 13|        4.0|       9.4|       1923|      2013|\n|Liberal Constitutionalist Party of Honduras |  2|       71.4|     100.0|       1916|      1923|\n|National Reformist Movement                 |  2|       13.6|      20.3|       1954|      1957|\n|Liberty and Refoundation                    |  1|       28.9|      28.9|       2013|      2013|\n|Anti-Corruption Party                       |  1|       10.2|      10.2|       2013|      2013|\n|Central American Unionist Party             |  1|        8.7|       8.7|       1926|      1926|\n|Democratic Unification Party                |  1|        3.9|       3.9|       2005|      2005|\n\n</div>\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nhnd |>\n  mutate(n = n(), .by = party) |>\n  filter(n > 10) |>\n  ggplot(aes(year, seats_share, colour = party)) +\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n---\n\n![](dataverse-url.png)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}