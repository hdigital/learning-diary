<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Learning</title>
<link>https://hdigital.github.io/learning-diary/</link>
<atom:link href="https://hdigital.github.io/learning-diary/index.xml" rel="self" type="application/rss+xml"/>
<description>Things I learned</description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Sun, 22 Sep 2024 00:00:00 GMT</lastBuildDate>
<item>
  <title>Arrange plots with tables</title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-09-22-r-patchwork/</link>
  <description><![CDATA[ 





<p>I use <a href="https://patchwork.data-imaginist.com/"><code>patchwork</code></a> regularly to combine ggplots; see my <a href="https://github.com/hdigital/starter-r">R template</a>.</p>
<p>The recent <a href="https://www.tidyverse.org/blog/2024/09/patchwork-1-3-0/">v1.3</a> release of <code>patchwork</code> allows adding <a href="https://www.tidyverse.org/blog/2024/09/patchwork-1-3-0/#tables-are-figures-too"><code>gt</code></a> tables.</p>
<p>Tables with short descriptive information are an essential element of my notebooks. So far, I have mainly relied on the default <a href="https://github.com/yihui/knitr"><code>knitr</code></a> for simple tables and used <a href="https://glin.github.io/reactable/"><code>reactable</code></a> for larger interactive tables.</p>
<p>So here is an example of <code>patchwork</code> that combines a figure and a <code>gt</code> table, using the <a href="https://allisonhorst.github.io/palmerpenguins/"><code>palmerpenguins</code></a> data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(palmerpenguins)</span>
<span id="cb1-6"></span>
<span id="cb1-7">pg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-8">  penguins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(species) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb1-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb1-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(bill_length_mm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">flipper =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(flipper_length_mm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb1-14">  )</span>
<span id="cb1-15"></span>
<span id="cb1-16">pl1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(penguins, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> flipper_length_mm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> bill_length_mm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(species))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb1-21"></span>
<span id="cb1-22">gt1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(pg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length mean (mm)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb1-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(bill, flipper),</span>
<span id="cb1-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-28">  )</span>
<span id="cb1-29"></span>
<span id="cb1-30">pl1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gt1</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-09-22-r-patchwork/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-09-22-r-patchwork/patchwork-logo.png" class="img-fluid"></p>



 ]]></description>
  <category>R</category>
  <category>ggplot</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-09-22-r-patchwork/</guid>
  <pubDate>Sun, 22 Sep 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-09-22-r-patchwork/patchwork-logo.png" medium="image" type="image/png" height="166" width="144"/>
</item>
<item>
  <title>uv instead of venv/pip</title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-08-31-uv/</link>
  <description><![CDATA[ 





<p><a href="https://docs.astral.sh/uv/">uv</a> recently released its <a href="https://github.com/astral-sh/uv/blob/main/CHANGELOG.md#030">0.3</a> version.</p>
<p><em>uv</em> is a package and project manager that potentially allows me to fully replace my venv/pip/pip-tools workflow and the use of <em>pyenv</em> as well as <em>pipx</em>. It provides a single tool, is significantly faster, and includes a complete project manager.</p>
<p>The 0.3 release added many new features and comprehensive documentation. Version <a href="https://github.com/astral-sh/uv/blob/main/CHANGELOG.md#040">0.4</a>, which revised the project workflow, has been released.</p>
<p>Package management has been challenging in Python and has often taken me a lot of time. <em>uv</em> has the potential to harmonize the approaches and tools I have used with a single tool.</p>
<p>Here are the <em>uv</em> commands relevant to me, a collection inspired by this <a href="https://simonwillison.net/2024/Aug/20/uv-unified-python-packaging/">post</a>.</p>
<section id="installation" class="level2">
<h2 class="anchored" data-anchor-id="installation">Installation</h2>
<p>It is recommended to <a href="https://docs.astral.sh/uv/getting-started/installation/">install</a> <em>uv</em> globally instead of using <code>pip install uv</code>.</p>
</section>
<section id="uv-workflow" class="level2">
<h2 class="anchored" data-anchor-id="uv-workflow">uv workflow</h2>
<p>Specify Python dependencies in a <code>pyproject.toml</code> (see Projects below).</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> add ruff</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> run ruff check</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> lock <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--upgrade</span></span>
<span id="cb1-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> sync</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .venv/bin/activate</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> python</span></code></pre></div>
</section>
<section id="projects" class="level2">
<h2 class="anchored" data-anchor-id="projects">Projects</h2>
<p>Create a project with a <code>README.md</code>, a <code>pyproject.toml</code>, and an example script.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> init</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> run hello.py</span></code></pre></div>
<p>You can also specify a project name to create the project in a new folder.</p>
</section>
<section id="python-versions" class="level2">
<h2 class="anchored" data-anchor-id="python-versions">Python versions</h2>
<p><em>uv</em> can install a specific <a href="https://docs.astral.sh/uv/concepts/python-versions/#installing-a-python-version">Python version</a> from <a href="https://github.com/indygreg/python-build-standalone">python-build-standalone</a>.</p>
<p>The Python version in a <code>pyproject.toml</code> or a <code>.python-version</code> file is used.</p>
<p>This allows me to replace <em>pyenv</em>, which I have used to manage different Python versions.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> venv <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--python</span> 3.11</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> python list</span>
<span id="cb3-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> python install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--reinstall</span> 3.10 3.11</span></code></pre></div>
<p>There may be minor differences with other Python builds.</p>
</section>
<section id="scripts" class="level2">
<h2 class="anchored" data-anchor-id="scripts">Scripts</h2>
<p>You can specify dependencies as <a href="https://packaging.python.org/en/latest/specifications/inline-script-metadata/#example">embedded metadata</a> in a script. <em>uv</em> will run the script and install the dependencies.</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import urllib3; print(urllib3.request("GET", "http://httpbin.org/robots.txt").data)'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> robots.py</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> add <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--script</span> robots.py urllib3</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> run robots.py</span></code></pre></div>
</section>
<section id="python-tools" class="level2">
<h2 class="anchored" data-anchor-id="python-tools">Python tools</h2>
<p>You can run and install Python tools with <a href="https://docs.astral.sh/uv/#tool-management"><code>uvx</code></a>.</p>
<p>It can be used as a replacement for <em>pipx</em>.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uvx</span> ruff clean</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> tool install ruff</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> ruff<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> tool list</span>
<span id="cb5-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> tool upgrade <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--all</span></span></code></pre></div>
</section>
<section id="venvpip-workflow" class="level2">
<h2 class="anchored" data-anchor-id="venvpip-workflow">venv/pip workflow</h2>
<p>My goal is to use the uv workflow, but here are some examples of using <em>uv</em> as as venv/pip/pip-tools replacement with the respective parameters.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> venv</span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> pip install urllib3</span>
<span id="cb6-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .venv/bin/activate</span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> python</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"urllib3"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> requirements.in</span>
<span id="cb6-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> pip compile <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-U</span> requirements.in <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> requirements.txt</span>
<span id="cb6-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> pip sync requirements.txt</span></code></pre></div>
</section>
<section id="clean-up" class="level2">
<h2 class="anchored" data-anchor-id="clean-up">Clean-up</h2>
<p>The <em>uv</em> cache folder can get large quickly, so it is helpful to clean it up regularly</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> cache prune</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> cache clean</span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">du</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> cache dir<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<p>Keep in mind that many <code>.venv</code> folders are created with a <em>uv</em> workflow, so you may want to remove them at some point.</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> . <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-type</span> d <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".venv"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-print0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0</span> du <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-sh</span></span></code></pre></div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-08-31-uv/python-logo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>Python</category>
  <category>packaging</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-08-31-uv/</guid>
  <pubDate>Sat, 31 Aug 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-08-31-uv/python-logo.png" medium="image" type="image/png" height="175" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-07-28-r-log10/</link>
  <description><![CDATA[ 





<section id="thousands-categories" class="level1">
<h1>Thousands categories</h1>
<p>I wanted to create categories of thousands and needed to put numbers into intervals of one, ten, and hundred thousands as well as millions.</p>
<p>Here is the solution I came up with using <img src="https://latex.codecogs.com/png.latex?10%5E%7B%5Clfloor%20%5Clog_%7B10%7D(x)%20%5Crfloor%7D"></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scipen =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">999</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb2-2"></span>
<span id="cb2-3">dt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb2-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> seed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb2-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb2-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">floor_log_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor</span>(log_x),</span>
<span id="cb2-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">category =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(x))</span>
<span id="cb2-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(x)</span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(dt, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(category))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"category"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-28-r-log10/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">seed</th>
<th style="text-align: right;">x</th>
<th style="text-align: right;">log_x</th>
<th style="text-align: right;">floor_log_x</th>
<th style="text-align: right;">category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">3400</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">4500</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.4</td>
<td style="text-align: right;">8400</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">16000</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">25000</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">26000</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">68000</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">95000</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">120000</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">100000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">1100000</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1300000</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.3</td>
<td style="text-align: right;">8300000</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">pl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000000</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> log10, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(x)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log10(x)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_comma</span>())</span>
<span id="cb4-7"></span>
<span id="cb4-8">pl</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-28-r-log10/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>R</category>
  <category>ggplot</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-07-28-r-log10/</guid>
  <pubDate>Sun, 28 Jul 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-07-28-r-log10/log10-plot.png" medium="image" type="image/png" height="108" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-07-20-r-round/</link>
  <description><![CDATA[ 





<section id="round-to-first-two-digits" class="level1">
<h1>Round to first two digits</h1>
<p>To improve the readability of a table, I wanted to round various numbers between 100 and 10,000,000 to their first two digits. 123,456 would become 120,000 and 987 would become 990.</p>
<p>Here is the solution I came up with.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7Bscale%7D%20%5Cleftarrow%2010%5E%7B%5Clceil%20%5Clog_%7B10%7D(x)%20%5Crceil%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7Bround%7D%5Cleft(%5Cfrac%7Bx%7D%7B%5Ctext%7Bscale%7D%7D,%202%5Cright)%20%5Ctimes%20%5Ctext%7Bscale%7D%0A"></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(purrr)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scipen =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">999</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">round_first_two <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb2-2">  scale <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(x))</span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> scale, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale</span>
<span id="cb2-4">}</span>
<span id="cb2-5"></span>
<span id="cb2-6">x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">113</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2795</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42459</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">442060</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6870466</span>)</span>
<span id="cb2-7"></span>
<span id="cb2-8">x1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]     113    2795   42459  442060 6870466</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dbl</span>(x1, round_first_two)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]     110    2800   42000  440000 6900000</code></pre>
</div>
</div>
<section id="copilot" class="level2">
<h2 class="anchored" data-anchor-id="copilot">Copilot</h2>
<p><a href="https://copilot.github.com/">GitHub Copilot</a> suggested a more general solution that works for numbers smaller and equal to zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">113</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2795</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42459</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">442060</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6870466</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb6-2"></span>
<span id="cb6-3">x2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]     113   -2795  -42459 -442060 6870466       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dbl</span>(x2, round_first_two)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]     110     NaN     NaN     NaN 6900000     NaN</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">round_first_two_digits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb10-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb10-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb10-4">  }</span>
<span id="cb10-5"></span>
<span id="cb10-6">  num_digits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(x))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb10-7">  scale_factor <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(num_digits <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> scale_factor) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale_factor</span>
<span id="cb10-9">}</span>
<span id="cb10-10"></span>
<span id="cb10-11">x2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]     113   -2795  -42459 -442060 6870466       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dbl</span>(x2, round_first_two_digits)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]     110   -2800  -42000 -440000 6900000       0</code></pre>
</div>
</div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-20-r-round/r-logo.png" class="img-fluid" style="width:33.0%"></p>


</section>
</section>

 ]]></description>
  <category>R</category>
  <category>AI</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-07-20-r-round/</guid>
  <pubDate>Sat, 20 Jul 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-07-20-r-round/r-logo.png" medium="image" type="image/png" height="112" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-07-17-r-sf-intersection/</link>
  <description><![CDATA[ 





<section id="select-map-region-in-r" class="level1">
<h1>Select map region in R</h1>
<p>Here is an example of selecting a region from a map by specifying a rectangle for the selection.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">cities <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-2">  maps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>world.cities <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(country.etc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Germany"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"long"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lat"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">agr =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"constant"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800000</span>, name, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_character_</span>))</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_rds</span>(cities, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cities-deu.rds"</span>)</span></code></pre></div>
</details>
</div>
<p>First, I create a map of German cities with more than 100,000 inhabitants.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb2-3"></span>
<span id="cb2-4">cities <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_rds</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cities-deu.rds"</span>)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(cities) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> pop), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey80"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-17-r-sf-intersection/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Then, I select the wider Ruhr area by defining the bottom left and the top right of the selection area.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">create_sf_rectangle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(xmin, xmax, ymin, ymax, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OGC:CRS84"</span>) {</span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(</span>
<span id="cb3-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(xmin, ymin, xmax, ymin, xmax, ymax, xmin, ymax, xmin, ymin),</span>
<span id="cb3-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-5">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> crs)</span>
<span id="cb3-9">}</span>
<span id="cb3-10"></span>
<span id="cb3-11">nrw_select <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_sf_rectangle</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">50.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.7</span>)</span>
<span id="cb3-12"></span>
<span id="cb3-13">nrw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb3-14">  cities <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(nrw_select)</span></code></pre></div>
</details>
</div>
<p>Finally, I create a map of the cities in the wider Ruhr area.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">nrw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>, name, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_character_</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> pop), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey80"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-17-r-sf-intersection/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-17-r-sf-intersection/sf-logo.png" class="img-fluid" style="width:33.0%"></p>


</section>

 ]]></description>
  <category>R</category>
  <category>geo</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-07-17-r-sf-intersection/</guid>
  <pubDate>Wed, 17 Jul 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-07-17-r-sf-intersection/sf-logo.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-07-16-r-bar-chart/</link>
  <description><![CDATA[ 





<section id="bar-charts-with-ggplot" class="level1">
<h1>Bar charts with ggplot</h1>
<p>Horizontal bar charts are a regular part of my work with graphs in R. Nevertheless, I have to look up the details regularly, so here is another example.</p>
<p>The graph visualizes the disproportionality of the results in the recent <a href="https://www.bbc.com/news/election/2024/uk/results">UK election 2024</a>.</p>
<p>It uses <a href="https://forcats.tidyverse.org/">forcats</a> to order categories, here the parties, by another value in the dataset, here the vote share.</p>
<p>The color codes of the parties are based on the BBC election page. I just used <em>inspect</em> on the internet browser to find the respective color code used on the page.</p>
<p>Finding the details for the parameters to customize the legend and the axes in ggplot took some time. <a href="https://github.com/features/copilot">GitHub Copilot</a>, my new AI pair programmer, was very helpful. In fact, I use it a lot now to get examples for the use of various tidyverse functions, that I used to look up regularly.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-3"></span>
<span id="cb1-4">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>())</span>
<span id="cb1-5"></span>
<span id="cb1-6"></span>
<span id="cb1-7">elec_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"uk-election-2024_bbc.csv"</span>)</span>
<span id="cb1-8"></span>
<span id="cb1-9">pl_dt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-10">  elec_raw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb1-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seat_share =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(seats <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">650</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># total seats UK Parliament: 650</span></span>
<span id="cb1-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">party =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(party, vote_share)</span>
<span id="cb1-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(vote_share <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-16"></span>
<span id="cb1-17">party_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb1-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lab"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E91D0E"</span>,</span>
<span id="cb1-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Con"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0575C9"</span>,</span>
<span id="cb1-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R-UK"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#12b6cf"</span>,</span>
<span id="cb1-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lib"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FF9A02"</span>,</span>
<span id="cb1-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Green"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#99CC33"</span>,</span>
<span id="cb1-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SNP"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0AD1E0"</span></span>
<span id="cb1-25">  )</span>
<span id="cb1-26"></span>
<span id="cb1-27">pl1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(pl_dt, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> vote_share, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> party, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> party)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlim</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> party_colors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb1-34"></span>
<span id="cb1-35">pl2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(pl_dt, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> seat_share, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> party, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> party)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> party_colors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb1-41"></span>
<span id="cb1-42">pl1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pl2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb1-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UK election 2024"</span>,</span>
<span id="cb1-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: BBC"</span></span>
<span id="cb1-46">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-16-r-bar-chart/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-16-r-bar-chart/union-jack_unsplash.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Photo by Kristina Gadeikyte on Unsplash</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>R</category>
  <category>ggplot</category>
  <category>AI</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-07-16-r-bar-chart/</guid>
  <pubDate>Tue, 16 Jul 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-07-16-r-bar-chart/bar-chart.png" medium="image" type="image/png" height="108" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-07-14-r-geocoding/</link>
  <description><![CDATA[ 





<section id="geocoding-in-r" class="level1">
<h1>Geocoding in R</h1>
<p>Geocoding of places in R with the <a href="https://github.com/jessecambon/tidygeocoder">tidygeocoder</a> package using the OpenStreetMap <a href="https://nominatim.org/release-docs/latest/">Nominatim API</a> and creating a <a href="https://r-spatial.github.io/sf/">sf</a> geometry list-column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb1-3"></span>
<span id="cb1-4">places <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb1-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">city =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb1-7">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Berlin"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bremen"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bielefeld"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dortmund"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dresden"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Flensburg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frankfurt"</span>,</span>
<span id="cb1-8">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Freiburg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hamburg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hannover"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kassel"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kln"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Konstanz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Leipzig"</span>,</span>
<span id="cb1-9">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Magdeburg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mnchen"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Passau"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rostock"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Trier"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nrnberg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Stuttgart"</span></span>
<span id="cb1-10">    )</span>
<span id="cb1-11">  )</span>
<span id="cb1-12"></span>
<span id="cb1-13">places <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-14">  places <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-15">  tidygeocoder<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geocode</span>(city, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"osm"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"long"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lat"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.fail =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_rds</span>(places, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deu-cities_sf.rds"</span>)</span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use data in rds-file to avoid geocoding request of 20s</span></span>
<span id="cb2-4">places <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_rds</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deu-cities_sf.rds"</span>)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> places, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> city)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4839"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LLC projection Germany</span></span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-14-r-geocoding/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-14-r-geocoding/tidygeocoder-logo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>R</category>
  <category>geo</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-07-14-r-geocoding/</guid>
  <pubDate>Sun, 14 Jul 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-07-14-r-geocoding/tidygeocoder-logo.png" medium="image" type="image/png" height="167" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-07-13-r-httr-doi/</link>
  <description><![CDATA[ 





<section id="doi-reference-with-httr2" class="level1">
<h1>DOI reference with httr2</h1>
<p>Get citation references from DOI API with httr2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(httr2)</span>
<span id="cb1-3"></span>
<span id="cb1-4">get_doi_reference <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(doi) {</span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">request</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://doi.org/"</span>, doi)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">req_headers</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accept"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text/x-bibliography"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">req_perform</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resp_body_string</span>()</span>
<span id="cb1-9">}</span>
<span id="cb1-10"></span>
<span id="cb1-11">references <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb1-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">doi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb1-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10.1177/1465116507076430"</span>,</span>
<span id="cb1-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10.1080/01402382.2013.783347"</span>,</span>
<span id="cb1-16">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10.1177/0958928715573481"</span>,</span>
<span id="cb1-17">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10.1017/pan.2021.28"</span></span>
<span id="cb1-18">    )</span>
<span id="cb1-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reference =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_chr</span>(doi, get_doi_reference))</span>
<span id="cb1-21"></span>
<span id="cb1-22">references</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 89%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">doi</th>
<th style="text-align: left;">reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">10.1177/1465116507076430</td>
<td style="text-align: left;">Dring, H. (2007). The Composition of the College of Commissioners. European Union Politics, 8(2), 207228. https://doi.org/10.1177/1465116507076430</td>
</tr>
<tr class="even">
<td style="text-align: left;">10.1080/01402382.2013.783347</td>
<td style="text-align: left;">Dring, H., &amp; Hellstrm, J. (2013). Who Gets into Government? Coalition Formation in European Democracies. West European Politics, 36(4), 683703. https://doi.org/10.1080/01402382.2013.783347</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10.1177/0958928715573481</td>
<td style="text-align: left;">Dring, H., &amp; Schwander, H. (2015). Revisiting the left cabinet share: How to measure the partisan profile of governments in welfare state research. Journal of European Social Policy, 25(2), 175193. https://doi.org/10.1177/0958928715573481</td>
</tr>
<tr class="even">
<td style="text-align: left;">10.1017/pan.2021.28</td>
<td style="text-align: left;">Herrmann, M., &amp; Dring, H. (2021). Party Positions from Wikipedia Classifications of Party Ideology. Political Analysis, 31(1), 2241. https://doi.org/10.1017/pan.2021.28</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-07-13-r-httr-doi/doi-logo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>R</category>
  <category>API</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-07-13-r-httr-doi/</guid>
  <pubDate>Sat, 13 Jul 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-07-13-r-httr-doi/doi-logo.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Today I learned (TIL)</title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-til/</link>
  <description><![CDATA[ 





<!--- Keeping brief information here that don't create a post. -->
<!--- Update date in header for new entries. -->
<section id="june" class="level2">
<h2 class="anchored" data-anchor-id="june">11. June</h2>
<p>Use <a href="https://adamj.eu/tech/2023/10/31/git-force-push-safely/">git force push safely</a> (2023) with</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> push <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--force-with-lease</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--force-if-includes</span></span></code></pre></div>
</section>
<section id="april" class="level2">
<h2 class="anchored" data-anchor-id="april">1. April</h2>
<p>For Python, Ive configured my OS to prevent pip installations outside of virtual environments by setting the PIP_REQUIRE_VIRTUALENV environment variable. For this configuration <code>export PIP_REQUIRE_VIRTUALENV="true"</code> is set in my .zshrc file. The configuration was inspired by the post <a href="https://micro.webology.dev/2024/03/04/pip-isolation.html">On pip isolation</a>.</p>
</section>
<section id="march" class="level2">
<h2 class="anchored" data-anchor-id="march">17. March</h2>
<p>Creating the <a href="../2024-02-26-f-strings">last post</a> I realized that it is more convenient to work in VS Code with a Jupyter notebook (<em>ipynb</em>) than in a Quarto document (<em>qmd</em>). The notebook enables the use of Jupyter keyboard shortcuts whereas the Quarto document usage is rather static in VS Code.</p>
<p>The documents can be converted into the other format with</p>
<p><code>quarto convert</code></p>
</section>
<section id="march-1" class="level2">
<h2 class="anchored" data-anchor-id="march-1">10. March</h2>
<p>Recently, I started using the <a href="https://github.com/casey/just">just</a> command runner and have now used it regularly in several of my Python projects.</p>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-til/computer_ai.png" class="img-fluid" width="300"></p>


</section>

 ]]></description>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-til/</guid>
  <pubDate>Tue, 11 Jun 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-til/computer_ai.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>pip install in cell</title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-04-30-py-pip-cell/</link>
  <description><![CDATA[ 





<p>Sometimes, I want to install <em>pip</em> packages in a Jupyter notebook without specifying the packages and pinning them in a <code>requirements.txt</code>.</p>
<p>This is mainly for short notebooks that I want to share and that should run without any modifications.</p>
<p>I have now found a solution with two IPython magic commands.</p>
<p><code>%%capture</code> suppresses cell output so that no information about the pip install or the already installed packages is added to the notebook.</p>
<p><code>%pip install</code> installs the specified packages.</p>
<div id="cell-2" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>capture</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>pip install goose3</span></code></pre></div>
</div>
<div id="cell-3" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> goose3 <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Goose</span>
<span id="cb2-2"></span>
<span id="cb2-3">url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.bbc.com/news/world-europe-68929873"</span></span>
<span id="cb2-4"></span>
<span id="cb2-5">g <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Goose()</span>
<span id="cb2-6">article <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> g.extract(url<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>url)</span>
<span id="cb2-7"></span>
<span id="cb2-8">article.meta_description</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>'Nicaragua accused Germany of breaching the UN genocide convention by sending military hardware to Israel.'</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-04-30-py-pip-cell/jupyter-logo.png" class="img-fluid figure-img"></p>
<figcaption>Jupyter</figcaption>
</figure>
</div>



 ]]></description>
  <category>Python</category>
  <category>packaging</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-04-30-py-pip-cell/</guid>
  <pubDate>Tue, 30 Apr 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-04-30-py-pip-cell/jupyter-logo.png" medium="image" type="image/png" height="161" width="144"/>
</item>
<item>
  <title>R in Docker and Codespaces</title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-03-22-r-codespaces/</link>
  <description><![CDATA[ 





<p>For my work, I use <a href="https://en.wikipedia.org/wiki/Docker_(software)">Docker</a> regularly to create fully reproducible environments.</p>
<section id="docker" class="level2">
<h2 class="anchored" data-anchor-id="docker">Docker</h2>
<p>Finding a configuration for <a href="https://www.r-project.org/">R</a> with <a href="https://rocker-project.org/">Rocker</a> has taken some effort over time and led to several changes.</p>
<p>Recently, working with <a href="https://pak.r-lib.org/">pak</a> has worked well for me to install all R packages when the container is build.</p>
<p>Here is a minimal example for such a workflow.</p>
<pre class="docker"><code>FROM rocker/tidyverse

WORKDIR /home/rstudio

COPY pkg.lock .
RUN R -e 'pak::lockfile_install()'</code></pre>
<p>The full example is available in my <a href="https://github.com/hdigital/starter-r/blob/main/Dockerfile">R template</a>. There, I use an <a href="https://github.com/hdigital/starter-r/blob/main/utils/packages-update.R">R script</a> to create a <code>pkg.lock</code> with the pinned versions of R packages used in a project.</p>
</section>
<section id="codespaces" class="level2">
<h2 class="anchored" data-anchor-id="codespaces">Codespaces</h2>
<p>Working with Python, I use <a href="../2023-06-04-codespaces/">Codespaces</a> quite regularly now. Figuring out a configuration with R took me some time. By now, I have a configuration that I feel comfortable with.</p>
<p>I started with the example from <a href="https://github.com/revodavid/devcontainers-rstudio">github.com/revodavid/devcontainers-rstudio</a> that demonstrates running RStudio in Codespaces.</p>
<p>Over time, I moved to a codespace configuration that uses more of the settings in <a href="https://github.com/hdigital/starter-r/blob/main/.devcontainer/devcontainer.json"><code>devcontainer.json</code></a> and a minimal <a href="https://github.com/hdigital/starter-r/blob/main/.devcontainer/Dockerfile"><code>Dockerfile</code></a>.</p>
<p>The codespace includes R, Python and Quarto. It takes quite some to build though.</p>
<p>Overall, it is a nice way to briefly explore an R project in a browser without installing any software locally. I keep codespaces only for a short time and delete them quickly. That is why I use <a href="2023-04-27-posit-cloud/">Posit Cloud</a> as a persistent online R environment.</p>
<p>Most of my R development is still in a local RStudio environment though. For reproducibility, I add a Docker configuration and make sure that the final version of a project can be replicated in that environment and has pinned versions of all dependencies.</p>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-03-22-r-codespaces/r-codespace.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>R</category>
  <category>cloud</category>
  <category>packaging</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-03-22-r-codespaces/</guid>
  <pubDate>Fri, 22 Mar 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-03-22-r-codespaces/rocker-logo.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-03-21-py-jupyterlite-urllib3/</link>
  <description><![CDATA[ 





<section id="requests-in-jupyterlite" class="level1">
<h1>Requests in JupyterLite</h1>
<p>In a recent <a href="../2023-11-23-jupyter-lite">post</a>, I tried to use <a href="https://requests.readthedocs.io/en/latest/user/quickstart/">requests</a> in <a href="https://jupyterlite.github.io/demo/lab/index.html">JupyterLite</a>. It did not work at the time.</p>
<p>Today, I have found out that <a href="https://github.com/urllib3/urllib3">urllib3</a> recently <a href="https://urllib3.readthedocs.io/en/stable/changelog.html#id2">announced</a> support for <a href="https://pyodide.org/en/stable/">Pyodide</a>, the Python distribution used by JupyterLite.</p>
<p>Now, you can use <code>requests</code> or <code>urllib3</code> in JupyterLite and this code does also work in the browser environment (install packages with <code>micropip</code>).</p>
<div id="c152c424" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># import micropip</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># await micropip.install("requests")</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> urllib3</span>
<span id="cb1-5">urllib3.disable_warnings()</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb1-8"></span>
<span id="cb1-9">headers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accept"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text/x-bibliography"</span>}</span>
<span id="cb1-10">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://doi.org/10.5281/zenodo.7043510"</span>, headers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>headers)</span>
<span id="cb1-11"></span>
<span id="cb1-12">r.text</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>'Dring, H., &amp;amp; Herrmann, M. (2024). &lt;i&gt;Party positions from Wikipedia tags&lt;/i&gt; (Version 24.07) [Computer software]. Zenodo. https://doi.org/10.5281/ZENODO.7043510'</code></pre>
</div>
</div>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-03-21-py-jupyterlite-urllib3/jupyterlite-urllib3.png" class="img-fluid"></p>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-03-21-py-jupyterlite-urllib3/jupyter-lite-logo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>Python</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-03-21-py-jupyterlite-urllib3/</guid>
  <pubDate>Thu, 21 Mar 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-03-21-py-jupyterlite-urllib3/jupyter-lite-logo.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2024-02-26-py-f-strings/</link>
  <description><![CDATA[ 





<section id="python-f-strings" class="level1">
<h1>Python f-strings</h1>
<p>Here are some examples of <a href="https://docs.python.org/3/tutorial/inputoutput.html#fancier-output-formatting">f-strings</a> in Python inspired by a <a href="https://note.nkmk.me/en/python-f-strings/">post</a> and a <a href="https://fstring.help/cheat/">cheat sheet</a>.</p>
<div id="0e759986" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-2">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span></code></pre></div>
</div>
<div id="72fa4961" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>a<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> + </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>'2 + 3'</code></pre>
</div>
</div>
<div id="522d0075" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> and </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>'a=2 and b=3'</code></pre>
</div>
</div>
<div id="0f90350b" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"a + b = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>'a + b = 5'</code></pre>
</div>
</div>
<p>Curly brackets in an f-string</p>
<div id="fc5d1d81" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">{{}}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">{{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">}}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>'{}-123-{123}'</code></pre>
</div>
</div>
<section id="number-formatting" class="level4">
<h4 class="anchored" data-anchor-id="number-formatting">Number formatting</h4>
<div id="1b93faf5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">var <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234567890.1234</span></span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>'1,234,567,890.1234'</code></pre>
</div>
</div>
<div id="80f971d2" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'round: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>'round: 1234567890.12'</code></pre>
</div>
</div>
<div id="40cb3458" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'comma: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>'comma: 1,234,567,890.1234'</code></pre>
</div>
</div>
<div id="ed0866e7" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'comma: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>'comma: 1,234,567,890.12'</code></pre>
</div>
</div>
<div id="3b303154" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datetime</span>
<span id="cb18-2"></span>
<span id="cb18-3">dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> datetime.datetime(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2026</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb18-4"></span>
<span id="cb18-5"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>'2026-02-21 19:45:30'</code></pre>
</div>
</div>
<div id="cc71065f" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-%</span>m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-%</span>d<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>'2026-02-21'</code></pre>
</div>
</div>
<div id="e4a38b88" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>isoformat()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>'2026-02-21T19:45:30'</code></pre>
</div>
</div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2024-02-26-py-f-strings/python-logo.png" class="img-fluid"></p>


</section>
</section>

 ]]></description>
  <category>Python</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2024-02-26-py-f-strings/</guid>
  <pubDate>Mon, 26 Feb 2024 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2024-02-26-py-f-strings/python-logo.png" medium="image" type="image/png" height="175" width="144"/>
</item>
<item>
  <title>Today I learned (TIL)  2023</title>
  <link>https://hdigital.github.io/learning-diary/posts/2023-til/</link>
  <description><![CDATA[ 





<!--- Keeping brief information here that don't create a post. -->
<!--- Update date in header for new entries. -->
<section id="november" class="level2">
<h2 class="anchored" data-anchor-id="november">26. November</h2>
<p>Keep the date of a git commit after changing the history with <code>rebase</code></p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> rebase <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--committer-date-is-author-date</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>SHA<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div>
</section>
<section id="november-1" class="level2">
<h2 class="anchored" data-anchor-id="november-1">21. November</h2>
<p>There is a <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-pip">magic method</a> in iPython to install packages with <em>pip</em>. It comes handy for a quick install in a notebook.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> requests</span></code></pre></div>
<p>Specifying dependencies in <code>requirements.in</code> or <code>pyproject.toml</code> and pinning them with <em>pip-tools</em> is the better solution to create reproducible environments.</p>
</section>
<section id="july" class="level2">
<h2 class="anchored" data-anchor-id="july">31. July</h2>
<p>Simple debugging with <a href="https://ipython.readthedocs.io/en/stable/">IPython</a>  found at <a href="https://realpython.com/ipython-interactive-python-shell/">Real Python</a> (now gated).</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPython</span>
<span id="cb3-2"></span>
<span id="cb3-3">var_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello"</span></span>
<span id="cb3-4"></span>
<span id="cb3-5">IPython.embed()</span>
<span id="cb3-6"></span>
<span id="cb3-7">var_2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world"</span></span></code></pre></div>
</section>
<section id="june" class="level2">
<h2 class="anchored" data-anchor-id="june">30. June</h2>
<p>Set <a href="https://quarto.org/docs/computations/r.html#data-frames">default printing</a> function for data frames in Quarto notebook with html option <code>df-print: kable</code>.</p>
<p>Useful to have html tables instead of monospace tables in notebooks.</p>
<p>So far, I prefer <code>kable</code> (<code>knitr::kable()</code>) over <code>paged</code> (<code>rmarkdown::paged_table())</code>).</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode yml code-with-copy"><code class="sourceCode yaml"><span id="cb4-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Document"</span></span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">   </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">     </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">df-print</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> kable</span></span>
<span id="cb4-6"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span></code></pre></div>
</section>
<section id="june-1" class="level2">
<h2 class="anchored" data-anchor-id="june-1">29. June</h2>
<p>Didnt know <a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct()</a> and used <code>length(unique())</code> for too long. A small and nice thing i learned that makes pipes more readable.</p>
</section>
<section id="june-2" class="level2">
<h2 class="anchored" data-anchor-id="june-2">13. June</h2>
<p>Adding a comment in Markdown by using standard html comments. It works for Markdown in <a href="https://pandoc.org/MANUAL.html">pandoc</a> used by Quarto.</p>
<pre><code>&lt;!--- comment  --&gt;

&lt;!---
multi-line comments
--&gt;</code></pre>
<p>I used it now with the current TIL page to have a short intro about a new TIL on the landing page. The previous one sentence summary of the page is now a comment.</p>
</section>
<section id="june-3" class="level2">
<h2 class="anchored" data-anchor-id="june-3">10. June</h2>
<p>Adding a <a href="https://quarto.org/docs/authoring/article-layout.html#page-breaks">page break</a> to a pdf in Quarto.</p>
<div class="sourceCode" id="cb6" data-shortcodes="false" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb6-2"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">format:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> pdf</span></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb6-4"></span>
<span id="cb6-5">Page 1</span>
<span id="cb6-6"></span>
<span id="cb6-7">{{&lt; pagebreak &gt;}}</span>
<span id="cb6-8"></span>
<span id="cb6-9">Page 2</span></code></pre></div>
<p>In addition, I learned to ignore shortcuts in a cell with <code>{.markdown shortcodes="false"}</code></p>
</section>
<section id="june-4" class="level2">
<h2 class="anchored" data-anchor-id="june-4">09. June</h2>
<p>I wanted to run a <a href="">Bash</a> shell script from any folder. The initial solution worked on my local computer but not on GitHub Codespaces. Here is the solution I came up with. The script runs from any location or stops and gives a message that it should be run from the script folder.</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use path relative to script location, if feasible</span></span>
<span id="cb7-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$BASH_SOURCE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dirname</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${BASH_SOURCE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-P</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb7-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">! </span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"package-lock.json"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-6">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Run script in project folder"</span></span>
<span id="cb7-7">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 1</span>
<span id="cb7-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span></code></pre></div>
</section>
<section id="may" class="level2">
<h2 class="anchored" data-anchor-id="may">17. May</h2>
<p>Another use of the Base-R shorthand anonymous function and explaining it to a colleague. I like to use <code>.x</code> now for the local variable name to make the local context more explicit.</p>
<p><code>add_three &lt;- \(.x) .x+3</code></p>
</section>
<section id="may-1" class="level2">
<h2 class="anchored" data-anchor-id="may-1">06. May</h2>
<p>Excluding variables in <em>tidyselect</em> is now done with <code>!</code> as I found out by reading the <a href="https://tidyselect.r-lib.org/reference/language.html">documentation</a> more carfully. I have still used <code>-</code> to exclude variables by their name. This is not documented in the tidyselect help page anymore.</p>
<p><a href="https://github.com/sjewo/readstata13">readstata13</a> creates more R friendly data structures than <a href="https://haven.tidyverse.org/">haven</a>. Its default option converts labeled data into factors if appropriate.</p>
</section>
<section id="may-2" class="level2">
<h2 class="anchored" data-anchor-id="may-2">05. May</h2>
<p>Used <a href="https://quarto.org/">Quarto</a> a lot and got more comfortable with the options  esp.&nbsp;caching, creating pdf, figures.</p>
</section>
<section id="may-3" class="level2">
<h2 class="anchored" data-anchor-id="may-3">03. May</h2>
<p>Convert an RMarkdown file into an R file with <code>knitr::purl("purl.Rmd")</code>  see <a href="https://bookdown.org/yihui/rmarkdown-cookbook/purl.html">details</a>.</p>
<p>ChatGPT did not provide the solution. I remembered doing this years ago. An internet search quickly led to the information needed.</p>
</section>
<section id="may-4" class="level2">
<h2 class="anchored" data-anchor-id="may-4">02. May</h2>
<p>A <a href="https://github.com/rstudio/rstudio/issues/12452">bug</a> in the current version of RStudio kept me busy. I reinstalled R and RStudio on Windows, but RStudio did not find the new R version afterwards. So I reinstalled the two and it kept not working. Fortunately, I found information about the RStudio bug somewhat quickly. I installed the <a href="https://dailies.rstudio.com/rstudio/mountain-hydrangea/">daily build</a> and had R/RStudio running again.</p>
<p>Originally, I only wanted to do a quick data analysis but my previous R/RStudio updates came in between.</p>
</section>
<section id="apr." class="level2">
<h2 class="anchored" data-anchor-id="apr.">25. Apr.</h2>
<p>I got back into <a href="https://quarto.org/">Quarto</a> and created a website for a learning project I have started. My goal is to have some structured information about topics of a book I am reading and some code snippets that apply concepts of the book.</p>
<p>Setting up the page worked well. I got a little confused by the quarto difference between <em>freeze</em> and <em>cache</em>. I also wondered why the <em>cache</em> was added into several folders in the main directory and not into a <em>_cache</em> folder.</p>
</section>
<section id="apr.-1" class="level2">
<h2 class="anchored" data-anchor-id="apr.-1">03. Apr.</h2>
<p>I read about the new <a href="https://pandas.pydata.org/docs/dev/whatsnew/v2.0.0.html">pandas release</a>. None of the changes seem to be relevant for my work with <em>pandas</em></p>
</section>
<section id="feb." class="level2">
<h2 class="anchored" data-anchor-id="feb.">25. Feb.</h2>
<p>I worked on <a href="https://github.com/hdigital/mixtape">code</a> from a causal inference book. It includes Stata, R and Python versions of the examples.</p>
<p>For R and Python I wanted to have one environment to install all dependencies. This led me to <a href="https://docs.conda.io/projects/conda/en/stable/user-guide/getting-started.html">conda</a>.</p>
<p>Creating a new conda environment in a new file was extremly slow. It also took me a while to fully configure Jupyter Lab with Python and R.</p>
<p>At the end, VS Code seems to be the more convenient interface.</p>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2023-til/computer_ai.png" class="img-fluid" width="300"></p>


</section>

 ]]></description>
  <guid>https://hdigital.github.io/learning-diary/posts/2023-til/</guid>
  <pubDate>Sun, 26 Nov 2023 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2023-til/computer_ai.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>iPython display</title>
  <link>https://hdigital.github.io/learning-diary/posts/2023-11-25-py-ipython-display/</link>
  <description><![CDATA[ 





<p>The <em>display</em> functions from <a href="https://ipython.readthedocs.io/en/stable/interactive/tutorial.html">iPython</a> is nice in an interactive Jupyter notebook. Unfortunately, it does not work equally well in Quarto or in a Jupyter notebook converted into html.</p>
<p>The <em>JSON</em> method is particularly helpful to explore a Python dictionary but does not work in rendered notebooks.</p>
<p>Nevertheless, it was good to get to know the functions and I add them here for the learning record.</p>
<hr>
<p>see the <a href="../../snippets/ipython-display-nbconvert.html">Jupyter notebook</a> (with <code>nbconvert</code>) and <a href="../../snippets/ipython-display.html">Quarto rendered</a> version.</p>
<section id="json" class="level2">
<h2 class="anchored" data-anchor-id="json">JSON</h2>
<div id="2df44756" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> JSON</span>
<span id="cb1-2"></span>
<span id="cb1-3">person <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb1-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'name'</span>: {</span>
<span id="cb1-5">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'first'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Jane'</span>,</span>
<span id="cb1-6">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'last'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Doe'</span></span>
<span id="cb1-7">    },</span>
<span id="cb1-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'age'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">43</span>,</span>
<span id="cb1-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'email'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'jane.doe@example.com'</span></span>
<span id="cb1-10">}</span>
<span id="cb1-11"></span>
<span id="cb1-12">JSON(person)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>&lt;IPython.core.display.JSON object&gt;</code></pre>
</div>
</div>
<p><img src="https://hdigital.github.io/learning-diary/posts/2023-11-25-py-ipython-display/json-screenshot.png" class="img-fluid"></p>
<hr>
</section>
<section id="single-element" class="level2">
<h2 class="anchored" data-anchor-id="single-element">Single element</h2>
<div id="8da8a47b" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Markdown, HTML, JSON, Math</span></code></pre></div>
</div>
<div id="e5df6d0e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">HTML(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;h2&gt;HTML Title&lt;/h2&gt;"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<h2 class="anchored">HTML Title</h2>
</div>
</div>
<div id="f398d88d" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">Markdown(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Markdown title"</span>)</span></code></pre></div>
<section id="markdown-title" class="level2 cell-output cell-output-display cell-output-markdown" data-execution_count="4">
<h2 class="anchored" data-anchor-id="markdown-title">Markdown title</h2>
</section>
</div>
<div id="1586ce4e" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">Math(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a^2 + b^2 = c^2"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="5">
<p><img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20a%5E2%20+%20b%5E2%20=%20c%5E2"></p>
</div>
</div>
<div id="c31ec643" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">JSON([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"foo"</span>, {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span>: (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baz"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}], expanded<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;IPython.core.display.JSON object&gt;</code></pre>
</div>
</div>
</section>
<section id="multiple-elements" class="level2">
<h2 class="anchored" data-anchor-id="multiple-elements">Multiple elements</h2>
<div id="1dc1a507" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">display(HTML(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;em&gt;HTML element&lt;/em&gt;"</span>))</span>
<span id="cb9-2">display(Markdown(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__Markdown title__"</span>))</span>
<span id="cb9-3">display(Math(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a^2 + b^2 = c^2"</span>))</span></code></pre></div>
<div class="cell-output cell-output-display">
<em>HTML element</em>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><strong>Markdown title</strong></p>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20a%5E2%20+%20b%5E2%20=%20c%5E2"></p>
</div>
</div>
<p>An example of a Quarto issue with <code>display()</code>. The elements are ordered differently in the code cell and the output.</p>
<div id="24c22a63" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'first element'"</span>)</span>
<span id="cb10-2">display(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"second element"</span>)</span>
<span id="cb10-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'third element'"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'first element'</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>'second element'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>'third element'</code></pre>
</div>
</div>
<p>Rendering of dictionaries with <code>JSON</code> does not work in Quarto or nbconvert.</p>
<hr>
</section>
<section id="quarto-workflow" class="level2">
<h2 class="anchored" data-anchor-id="quarto-workflow">Quarto workflow</h2>
<p>A note how I render the Jupyter notebook of the post.</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> snippets <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb14-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ruff</span> format ipython-display.ipynb <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb14-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">jupyter-nbconvert</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--execute</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--inplace</span> ipython-display.ipynb <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb14-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">nbdev_clean</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--fname</span> ipython-display.ipynb <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb14-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">jupyter-nbconvert</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--to</span> html ipython-display.ipynb <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> ipython-display-nbconvert.html</span></code></pre></div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2023-11-25-py-ipython-display/ipython-logo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>Python</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2023-11-25-py-ipython-display/</guid>
  <pubDate>Sat, 25 Nov 2023 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2023-11-25-py-ipython-display/ipython-logo.png" medium="image" type="image/png" height="43" width="144"/>
</item>
<item>
  <title>JupyterLite</title>
  <link>https://hdigital.github.io/learning-diary/posts/2023-11-23-py-jupyter-lite/</link>
  <description><![CDATA[ 





<p>I listened to the the recent <em>Talk Python To Me</em> episode <a href="https://talkpython.fm/episodes/show/438/celebrating-jupyterlab-4-and-jupyter-7-releases">Celebrating JupyterLab 4 and Jupyter 7 Releases</a> and became aware of <a href="https://github.com/jupyterlite">JupyterLite</a> which I had not used before.</p>
<p>I was impressed to see that you can now <a href="https://jupyterlite.github.io/demo/lab/index.html">run JupyterLab in a browser</a>.</p>
<p>Many shortcuts work and you can activate the command pallette with <em>Shift + Cmd/Ctrl + C</em></p>
<p>For me, the examples in the <em>pyodide</em> folder were helpful and demonstrated how much Python data analysis can be already done with this fully web based version of Jupyter.</p>
<p>So now I can run Python in an interactive environment on any computer with JupyterLite. I may use <em>Codespaces</em> or <em>Google Colab</em> in a browser more often because they provide the standard Python environment. For small snippets and examples I will also use JupyterLite.</p>
<section id="visualization-example" class="level2">
<h2 class="anchored" data-anchor-id="visualization-example">Visualization example</h2>
<p>Here is an example form the <em>altair.ipynb</em> notebook in the <em>pyodide</em> folder. It runs here but also in the JupyterLite, purely browser based, version.</p>
<div id="f38a270b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> altair <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> alt</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-3"></span>
<span id="cb1-4">source <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({</span>
<span id="cb1-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a'</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'B'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'D'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'E'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'F'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'G'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'I'</span>],</span>
<span id="cb1-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">43</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">91</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">81</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">53</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">87</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">52</span>]</span>
<span id="cb1-7">})</span>
<span id="cb1-8"></span>
<span id="cb1-9">alt.Chart(source).mark_bar().encode(</span>
<span id="cb1-10">    x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a'</span>,</span>
<span id="cb1-11">    y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span></span>
<span id="cb1-12">)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">

<style>
  #altair-viz-713f0858f9364127836bd6d640501617.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-713f0858f9364127836bd6d640501617.vega-embed details,
  #altair-viz-713f0858f9364127836bd6d640501617.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-713f0858f9364127836bd6d640501617"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-713f0858f9364127836bd6d640501617") {
      outputDiv = document.getElementById("altair-viz-713f0858f9364127836bd6d640501617");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-7684334a68ab74ba4c3ca7d0ceaeb461"}, "mark": {"type": "bar"}, "encoding": {"x": {"field": "a", "type": "nominal"}, "y": {"field": "b", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-7684334a68ab74ba4c3ca7d0ceaeb461": [{"a": "A", "b": 28}, {"a": "B", "b": 55}, {"a": "C", "b": 43}, {"a": "D", "b": 91}, {"a": "E", "b": 81}, {"a": "F", "b": 53}, {"a": "G", "b": 19}, {"a": "H", "b": 87}, {"a": "I", "b": 52}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="http-requests" class="level2">
<h2 class="anchored" data-anchor-id="http-requests">http requests</h2>
<p>I played around a little with making http requests. You can install the <a href="https://github.com/psf/requests">requests</a> package but the http requests dont work. You have to use the <a href="https://pyodide.org/en/stable/usage/api/js-api.html">js</a> module provided by <a href="https://github.com/pyodide/pyodide">pyodide</a> instead.</p>
<p>Here is the notebook I wrote.</p>
<p><a href="network-requests.ipynb.txt">network-requests.ipynb.txt</a></p>
<p>I added a <em>txt</em> extension because I dont want the notebook to be rendered in Quarto. Save it, remove the <em>txt</em> extension, drag and drop it into the JupyterLite browser window and run it.</p>
</section>
<section id="pip-with-micropip" class="level2">
<h2 class="anchored" data-anchor-id="pip-with-micropip">pip with micropip</h2>
<p>You can install packages with <em>pip</em>. In JupyterLite, it is based on <a href="https://github.com/pyodide/micropip">micropip</a>.</p>
<p>The <a href="https://jupyterlite.readthedocs.io/en/latest/howto/pyodide/packages.html#installing-packages-at-runtime">recommended</a> way to install packages is:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> snowballstemmer</span></code></pre></div>
<p>So far, I have been reluctant to use pip with a <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-pip">magic command</a> but may use it more regularly in the future.</p>
<p>Here is a Python version to use <em>micropip</em>.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> micropip</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"snowballstemmer"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> micropip.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>():</span>
<span id="cb3-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">await</span> micropip.install(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"snowballstemmer"</span>)</span></code></pre></div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2023-11-23-py-jupyter-lite/jupyter-lite-logo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>Python</category>
  <category>packaging</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2023-11-23-py-jupyter-lite/</guid>
  <pubDate>Thu, 23 Nov 2023 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2023-11-23-py-jupyter-lite/jupyter-lite-logo.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>API requests with httr2</title>
  <link>https://hdigital.github.io/learning-diary/posts/2023-11-20-r-httr/</link>
  <description><![CDATA[ 





<p><a href="https://www.tidyverse.org/blog/2023/11/httr2-1-0-0/">httr2 1.0</a> was recently released. I used it earlier this month in my API explorations to understand what the Python <a href="https://github.com/psf/requests">requests</a> equivalent is in R. Python and <em>requests</em> are so convenient that I had not used R yet to access an API.</p>
<p>I became aware of <a href="https://www.semanticscholar.org/author/Holger-D%C3%B6ring/51362391">Semantic Scholar</a>, a database of scientific literature, with a nice <a href="https://api.semanticscholar.org/api-docs/">API</a>.</p>
<p>So here is an exploration of my Semantic Scholar records (ID 51362391) in R with httr2.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(httr2)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(jsonlite)</span></code></pre></div>
</details>
</div>
<section id="api-request" class="level2">
<h2 class="anchored" data-anchor-id="api-request">API request</h2>
<p><a href="https://api.semanticscholar.org/api-docs/#tag/Author-Data/operation/get_graph_get_author">API  Fetch paper and author data</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">author_id <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">51362391</span></span>
<span id="cb2-2"></span>
<span id="cb2-3">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_glue</span>(</span>
<span id="cb2-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://api.semanticscholar.org/graph/v1/author/{author_id}"</span>,</span>
<span id="cb2-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"?fields=name,papers,papers.year,papers.title,papers.citationCount,papers.authors"</span></span>
<span id="cb2-7">  )</span>
<span id="cb2-8"></span>
<span id="cb2-9">resp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">request</span>(url) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">req_perform</span>()</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">dt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resp_body_string</span>(resp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>()</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(dt[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Holger Dring"</code></pre>
</div>
</div>
</section>
<section id="publications" class="level2">
<h2 class="anchored" data-anchor-id="publications">Publications</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">papers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb5-2">  dt[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"papers"</span>]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_short =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(paperId, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb5-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title_short =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(title, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>),</span>
<span id="cb5-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">authors_n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_int</span>(authors, \(.x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.x))</span>
<span id="cb5-7">  )</span></code></pre></div>
</div>
<p>Number of publications at Semantic Scholar</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(papers)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
</div>
<p>Publications</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">papers <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id_short, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cita.</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> citationCount, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auth.</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> authors_n, title_short)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">id_short</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">cita.</th>
<th style="text-align: right;">auth.</th>
<th style="text-align: left;">title_short</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a9408</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Formal binary logic, tidal for</td>
</tr>
<tr class="even">
<td style="text-align: left;">c229b</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Beyond the light-barrier -fast</td>
</tr>
<tr class="odd">
<td style="text-align: left;">e3034</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Occams Razor-No Dark Matter in</td>
</tr>
<tr class="even">
<td style="text-align: left;">37135</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Lorentzian SRT-Transformation</td>
</tr>
<tr class="odd">
<td style="text-align: left;">84d1f</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Germany: From Stable Coalition</td>
</tr>
<tr class="even">
<td style="text-align: left;">8bd34</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Institutional constraints on c</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1b9e9</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Party Positions from Wikipedia</td>
</tr>
<tr class="even">
<td style="text-align: left;">e9e28</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Party Facts: A database of pol</td>
</tr>
<tr class="odd">
<td style="text-align: left;">f93aa</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Gathering and Managing Data on</td>
</tr>
<tr class="even">
<td style="text-align: left;">69fe5</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Mapping established democracie</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4175b</td>
<td style="text-align: right;">2015</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Is Proportional Representation</td>
</tr>
<tr class="even">
<td style="text-align: left;">85957</td>
<td style="text-align: right;">2015</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">How do European democracies co</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a9372</td>
<td style="text-align: right;">2015</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Revisiting the left cabinet sh</td>
</tr>
<tr class="even">
<td style="text-align: left;">34e81</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Jean-Claude Junckers new Euro</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1273f</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Who Gets into Government? Coal</td>
</tr>
<tr class="even">
<td style="text-align: left;">31eff</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">The collective action of data</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c01fd</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Ministerial Careers and The M</td>
</tr>
<tr class="even">
<td style="text-align: left;">c4f64</td>
<td style="text-align: right;">2011</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Why are States with Pr More Re</td>
</tr>
<tr class="odd">
<td style="text-align: left;">e3cbe</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Collaborative Data Collection</td>
</tr>
<tr class="even">
<td style="text-align: left;">f5948</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Political representation in Eu</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2ebbf</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Electoral and Mechanical Cause</td>
</tr>
<tr class="even">
<td style="text-align: left;">ec86a</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Evaluating Scripting Languages</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14ab0</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">The Composition of the College</td>
</tr>
<tr class="even">
<td style="text-align: left;">9674d</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Divided Government European St</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="authors" class="level2">
<h2 class="anchored" data-anchor-id="authors">Authors</h2>
<p>Authors by paper</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">authors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb9-2">  papers <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id_short, year, authors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unnest</span>(authors)</span>
<span id="cb9-5"></span>
<span id="cb9-6">authors</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">id_short</th>
<th style="text-align: right;">year</th>
<th style="text-align: left;">authorId</th>
<th style="text-align: left;">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a9408</td>
<td style="text-align: right;">2022</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">c229b</td>
<td style="text-align: right;">2022</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">e3034</td>
<td style="text-align: right;">2022</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">37135</td>
<td style="text-align: right;">2021</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">84d1f</td>
<td style="text-align: right;">2021</td>
<td style="text-align: left;">94263396</td>
<td style="text-align: left;">M. Debus</td>
</tr>
<tr class="even">
<td style="text-align: left;">84d1f</td>
<td style="text-align: right;">2021</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">84d1f</td>
<td style="text-align: right;">2021</td>
<td style="text-align: left;">143708020</td>
<td style="text-align: left;">Alejandro Ecker</td>
</tr>
<tr class="even">
<td style="text-align: left;">8bd34</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">119358998</td>
<td style="text-align: left;">Maria Thrk</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8bd34</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">145985059</td>
<td style="text-align: left;">Johan Hellstrm</td>
</tr>
<tr class="even">
<td style="text-align: left;">8bd34</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1b9e9</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">145315358</td>
<td style="text-align: left;">M. Herrmann</td>
</tr>
<tr class="even">
<td style="text-align: left;">1b9e9</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">e9e28</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">e9e28</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">1685592</td>
<td style="text-align: left;">Sven Regel</td>
</tr>
<tr class="odd">
<td style="text-align: left;">f93aa</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">69fe5</td>
<td style="text-align: right;">2016</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4175b</td>
<td style="text-align: right;">2015</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">4175b</td>
<td style="text-align: right;">2015</td>
<td style="text-align: left;">2072035416</td>
<td style="text-align: left;">P. Manow</td>
</tr>
<tr class="odd">
<td style="text-align: left;">85957</td>
<td style="text-align: right;">2015</td>
<td style="text-align: left;">144008442</td>
<td style="text-align: left;">Jonathan Bright</td>
</tr>
<tr class="even">
<td style="text-align: left;">85957</td>
<td style="text-align: right;">2015</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">85957</td>
<td style="text-align: right;">2015</td>
<td style="text-align: left;">145474393</td>
<td style="text-align: left;">Conor Little</td>
</tr>
<tr class="even">
<td style="text-align: left;">a9372</td>
<td style="text-align: right;">2015</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a9372</td>
<td style="text-align: right;">2015</td>
<td style="text-align: left;">115016266</td>
<td style="text-align: left;">Hanna Schwander</td>
</tr>
<tr class="even">
<td style="text-align: left;">34e81</td>
<td style="text-align: right;">2014</td>
<td style="text-align: left;">82184129</td>
<td style="text-align: left;">A. Wonka</td>
</tr>
<tr class="odd">
<td style="text-align: left;">34e81</td>
<td style="text-align: right;">2014</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">1273f</td>
<td style="text-align: right;">2013</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1273f</td>
<td style="text-align: right;">2013</td>
<td style="text-align: left;">145985059</td>
<td style="text-align: left;">Johan Hellstrm</td>
</tr>
<tr class="even">
<td style="text-align: left;">31eff</td>
<td style="text-align: right;">2013</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c01fd</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">144008442</td>
<td style="text-align: left;">Jonathan Bright</td>
</tr>
<tr class="even">
<td style="text-align: left;">c01fd</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c01fd</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">145474393</td>
<td style="text-align: left;">Conor Little</td>
</tr>
<tr class="even">
<td style="text-align: left;">c4f64</td>
<td style="text-align: right;">2011</td>
<td style="text-align: left;">2072035416</td>
<td style="text-align: left;">P. Manow</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c4f64</td>
<td style="text-align: right;">2011</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">e3cbe</td>
<td style="text-align: right;">2010</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">f5948</td>
<td style="text-align: right;">2009</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">2ebbf</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">2072035416</td>
<td style="text-align: left;">P. Manow</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2ebbf</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">ec86a</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14ab0</td>
<td style="text-align: right;">2007</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
<tr class="even">
<td style="text-align: left;">9674d</td>
<td style="text-align: right;">2006</td>
<td style="text-align: left;">2072035416</td>
<td style="text-align: left;">P. Manow</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9674d</td>
<td style="text-align: right;">2006</td>
<td style="text-align: left;">51362391</td>
<td style="text-align: left;">Holger Dring</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2023-11-20-r-httr/httr2-logo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>R</category>
  <category>API</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2023-11-20-r-httr/</guid>
  <pubDate>Mon, 20 Nov 2023 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2023-11-20-r-httr/httr2-logo.png" medium="image" type="image/png" height="166" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2023-11-17-py-python-pizza/</link>
  <description><![CDATA[ 





<section id="python-pizza-hamburg" class="level1">
<h1>Python Pizza Hamburg</h1>
<p>This Friday, I attended the <a href="https://hamburg.python.pizza/">Python Pizza micro conference</a> in Hamburg. It was a very nice, welcoming and informative event. I liked the broad perspectives on how-to, learning and diversity. The topics of the talks were very accessible and mainly experience based.</p>
<p>Some of the technical things I took out:</p>
<ul>
<li>Streamlit: Making Data Shine in Minute (Alessandro Romano) showed me that <a href="https://github.com/streamlit/streamlit">Streamlit</a> may be the tool I need to quickly create data dashboards without getting into webdev details.</li>
<li>Introducing the ORMIR community and the book Learn Python with Jupyter (Serena Bonaretti) helped me to better understand the evolving relation between open source, open science, research and learning.</li>
<li>Choose HTMX and avoid learning too much JavaScript (Martin Borus) demonstrated once more that I should start to experiment with <a href="https://github.com/bigskysoftware/htmx">htmx</a>. I run the <a href="https://github.com/mborus/choose_htmx">repository code</a> in Codespaces later and want to try <a href="https://github.com/tiangolo/fastapi">FastAPI</a> and async web page element reloading.</li>
</ul>
<p>The friendly environment and some nice exchanges about data science, Python, and open source projects over delicious pizza were really nice.</p>
<hr>
<p>This was a Python Pizza conference. So I asked ChatGPT to draw a Pizza in Python, something it happily did.</p>
<p>ChatGPT message: <em>draw a figure of a pizza in python in a jupyter notebook</em></p>
<p>This provided code for a pizza with peperoni. I tried to get a <a href="https://altair-viz.github.io/">Vega-Altair</a> version but this did not work out. So I stayed with the <a href="https://matplotlib.org/">Matplotlib</a> version and asked to have some pizza slices.</p>
<p>ChatGPT message: <em>add slices to the matplotlib plot</em></p>
<div id="4223e4d3" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> patches</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a figure and axis</span></span>
<span id="cb1-5">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Draw the pizza circle</span></span>
<span id="cb1-8">pizza_circle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.Circle((<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'brown'</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-9">ax.add_patch(pizza_circle)</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Draw the cheese circle (a smaller circle on top of the pizza)</span></span>
<span id="cb1-12">cheese_circle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.Circle((<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'yellow'</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-13">ax.add_patch(cheese_circle)</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Draw pizza slices</span></span>
<span id="cb1-16">num_slices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb1-17">theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> num_slices</span>
<span id="cb1-18">slice_colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'orange'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lightgreen'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tomato'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'wheat'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lightcoral'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lightblue'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sandybrown'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lightpink'</span>]</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_slices):</span>
<span id="cb1-21">    slice_wedge <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> patches.Wedge((<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> theta, (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> theta, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>slice_colors[i], fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-22">    ax.add_patch(slice_wedge)</span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set aspect ratio to be equal</span></span>
<span id="cb1-25">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>, adjustable<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>)</span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set axis limits</span></span>
<span id="cb1-28">ax.set_xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-29">ax.set_ylim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove axis labels and ticks</span></span>
<span id="cb1-32">ax.set_xticks([])</span>
<span id="cb1-33">ax.set_yticks([])</span>
<span id="cb1-34">ax.set_xticklabels([])</span>
<span id="cb1-35">ax.set_yticklabels([])</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set the title</span></span>
<span id="cb1-38">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delicious Pizza with Slices"</span>)</span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the plot</span></span>
<span id="cb1-41">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://hdigital.github.io/learning-diary/posts/2023-11-17-py-python-pizza/index_files/figure-html/cell-2-output-1.png" width="389" height="409" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2023-11-17-py-python-pizza/python-pizza-photo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>Python</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2023-11-17-py-python-pizza/</guid>
  <pubDate>Fri, 17 Nov 2023 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2023-11-17-py-python-pizza/python-pizza-logo.png" medium="image" type="image/png" height="117" width="144"/>
</item>
<item>
  <title></title>
  <link>https://hdigital.github.io/learning-diary/posts/2023-11-04-py-pyproject-toml/</link>
  <description><![CDATA[ 





<section id="pyproject.toml-metadata-and-dependencies" class="level1">
<h1>pyproject.toml metadata and dependencies</h1>
<p>Python allows to specify <a href="https://packaging.python.org/en/latest/specifications/declaring-project-metadata/#declaring-project-metadata">metadata</a> and <a href="https://packaging.python.org/en/latest/specifications/declaring-project-metadata/#dependencies-optional-dependencies">dependencies</a> in a <code>pyproject.toml</code>.</p>
<p>I have started using the <em>metadata</em> declaration recently and tried the dependency specification this week.</p>
<p>I added an <a href="pyproject.toml">example</a> to the folder of the post. It contains project metadata and examples for project and development dependencies.</p>
<div id="175ab62e" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> print_file(file_name):</span>
<span id="cb1-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(file_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r"</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>:</span>
<span id="cb1-3">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>.read())</span>
<span id="cb1-4"></span>
<span id="cb1-5">print_file(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pyproject.toml"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[project]
name = "hd-example"
version = "0.1"
description = "An example for pyproject"
maintainers = [{ name = "Holger Dring" }]
license = { text = "MIT License" }
requires-python = "&gt;=3.11"
dependencies = [
  "requests",
]

[project.optional-dependencies]
dev = [
  "pip-tools",
  "ruff",
]

[project.urls]
 homepage = ""
repository = "https://github.com/hdigital/starter-python.git"


# specify build system to run pip-tools
# (application is not a package and no build is needed)
[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"
</code></pre>
</div>
</div>
<p>There is a <a href="https://docs.python.org/3/library/tomllib.html">toml parser</a> in the standard library since Python 3.11, released in October last year. It can be used to read the <code>pyproject.toml</code>.</p>
<div id="dea302a6" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tomli <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tomllib  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python &lt;= 3.10</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pyproject.toml"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rb"</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> toml_file:</span>
<span id="cb3-4">    toml_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tomllib.load(toml_file)</span>
<span id="cb3-5"></span>
<span id="cb3-6">toml_data</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>{'project': {'name': 'hd-example',
  'version': '0.1',
  'description': 'An example for pyproject',
  'maintainers': [{'name': 'Holger Dring'}],
  'license': {'text': 'MIT License'},
  'requires-python': '&gt;=3.11',
  'dependencies': ['requests'],
  'optional-dependencies': {'dev': ['pip-tools', 'ruff']},
  'urls': {'homepage': '',
   'repository': 'https://github.com/hdigital/starter-python.git'}},
 'build-system': {'requires': ['hatchling'],
  'build-backend': 'hatchling.build'}}</code></pre>
</div>
</div>
<p>I like to pin dependencies in one <code>requirements.txt</code>. Such a file can be created with <a href="https://github.com/jazzband/pip-tools#requirements-from-pyprojecttoml">pip-tools</a>.</p>
<p><code>python -m piptools compile --upgrade --extra dev pyproject.toml</code></p>
<p>Usually, I include the <code>--generate-hashes</code> option but leave it out here to shorten the output by not including hash keys.</p>
<div id="57eb3126" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">print_file(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"requirements.txt"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#
# This file is autogenerated by pip-compile with Python 3.11
# by the following command:
#
#    pip-compile --extra=dev pyproject.toml
#
build==1.0.3
    # via pip-tools
certifi==2023.7.22
    # via requests
charset-normalizer==3.3.2
    # via requests
click==8.1.7
    # via pip-tools
idna==3.4
    # via requests
packaging==23.2
    # via build
pip-tools==7.3.0
    # via hd-example (pyproject.toml)
pyproject-hooks==1.0.0
    # via build
requests==2.31.0
    # via hd-example (pyproject.toml)
ruff==0.1.4
    # via hd-example (pyproject.toml)
urllib3==2.0.7
    # via requests
wheel==0.41.3
    # via pip-tools

# The following packages are considered to be unsafe in a requirements file:
# pip
# setuptools
</code></pre>
</div>
</div>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2023-11-04-py-pyproject-toml/python-logo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>Python</category>
  <category>packaging</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2023-11-04-py-pyproject-toml/</guid>
  <pubDate>Sat, 04 Nov 2023 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2023-11-04-py-pyproject-toml/python-logo.png" medium="image" type="image/png" height="175" width="144"/>
</item>
<item>
  <title>Zenodo API</title>
  <link>https://hdigital.github.io/learning-diary/posts/2023-10-31-py-zenodo-api/</link>
  <description><![CDATA[ 





<p>This week, I worked with the Zenodo API. My goals was to add Zenodo metadata to GitHub for the <a href="https://github.com/hdigital/partypositions-wikitags">partypositions-wikitags</a> project.</p>
<p>The code of the project is archived at Zenodo with the DOI <a href="https://zenodo.org/doi/10.5281/zenodo.7043510">10.5281/zenodo.7043510</a>.</p>
<div id="9588d893" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb1-2"></span>
<span id="cb1-3">headers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accept"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text/x-bibliography"</span>}</span>
<span id="cb1-4">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://doi.org/10.5281/zenodo.7043510"</span>, headers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>headers)</span>
<span id="cb1-5"></span>
<span id="cb1-6">r.text</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>'Dring, H., &amp;amp; Herrmann, M. (2024). &lt;i&gt;Party positions from Wikipedia tags&lt;/i&gt; (Version 24.07) [Computer software]. Zenodo. https://doi.org/10.5281/ZENODO.7043510'</code></pre>
</div>
</div>
<section id="doi-api" class="level2">
<h2 class="anchored" data-anchor-id="doi-api">DOI API</h2>
<p>So here is some metadata information. Lets start with the DOI API.</p>
<div id="24ba113a" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb3-2"></span>
<span id="cb3-3">doi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10.5281/zenodo.7043510"</span></span>
<span id="cb3-4"></span>
<span id="cb3-5">headers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accept"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"application/vnd.citationstyles.csl+json"</span>}</span>
<span id="cb3-6">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"https://doi.org/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>doi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, headers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>headers)</span>
<span id="cb3-7"></span>
<span id="cb3-8">r.json()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>{'type': 'book',
 'id': 'https://doi.org/10.5281/zenodo.7043510',
 'language': 'en',
 'author': [{'family': 'Dring', 'given': 'Holger'},
  {'family': 'Herrmann', 'given': 'Michael'}],
 'issued': {'date-parts': [[2024, 7, 31]]},
 'abstract': 'Estimation of party positions from Wikipedia tags with Stan',
 'DOI': '10.5281/ZENODO.7043510',
 'publisher': 'Zenodo',
 'title': 'Party positions from Wikipedia tags',
 'URL': 'https://zenodo.org/doi/10.5281/zenodo.7043510',
 'copyright': 'MIT License',
 'version': '24.07'}</code></pre>
</div>
</div>
</section>
<section id="zenodo-record" class="level2">
<h2 class="anchored" data-anchor-id="zenodo-record">Zenodo record</h2>
<p>We can also access a <a href="https://developers.zenodo.org/#retrieve37">record</a> through the Zenodo API. This does not require a <a href="https://developers.zenodo.org/#authentication">Zenodo access token</a>.</p>
<div id="689645d4" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://zenodo.org/api/records/8275697"</span>)</span>
<span id="cb5-2">record <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r.json()</span>
<span id="cb5-3"></span>
<span id="cb5-4">record.keys()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>dict_keys(['created', 'modified', 'id', 'conceptrecid', 'doi', 'conceptdoi', 'doi_url', 'metadata', 'title', 'links', 'updated', 'recid', 'revision', 'files', 'owners', 'status', 'stats', 'state', 'submitted'])</code></pre>
</div>
</div>
<p>I was interested in the Zenodo metadata.</p>
<div id="6720aebc" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">record[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'metadata'</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>{'title': 'Party positions from Wikipedia tags (July 2023)',
 'doi': '10.5281/zenodo.8275697',
 'publication_date': '2023-08-23',
 'description': '&lt;p&gt;Estimation of party positions from Wikipedia tags with Stan (July 2023)&lt;/p&gt;',
 'access_right': 'open',
 'creators': [{'name': 'Holger Dring',
   'affiliation': 'GESIS  Leibniz Institute for the Social Sciences'},
  {'name': 'Michael Herrmann', 'affiliation': 'University of Konstanz'}],
 'related_identifiers': [{'identifier': 'https://github.com/hdigital/partypositions-wikitags/tree/23.07',
   'relation': 'isSupplementTo',
   'scheme': 'url'}],
 'version': '23.07',
 'resource_type': {'title': 'Software', 'type': 'software'},
 'license': {'id': 'other-open'},
 'relations': {'version': [{'index': 1,
    'is_last': False,
    'parent': {'pid_type': 'recid', 'pid_value': '7043510'}}]}}</code></pre>
</div>
</div>
</section>
<section id="github-metadata" class="level2">
<h2 class="anchored" data-anchor-id="github-metadata">GitHub metadata</h2>
<p>Some of the metadata is imported by Zenodo from Github and some metadata needs to be added or updated manually.</p>
<p>You can specify some of the addtional metadata in a <code>.zenodo.json</code> file in your GitHub repository.</p>
<p><a href="https://developers.zenodo.org/#github" class="uri">https://developers.zenodo.org/#github</a></p>
<p>I used the archived Zenodo record for a json dump of the metadata.</p>
<div id="cdf00213" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(json.dumps(record[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'metadata'</span>], indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
  "title": "Party positions from Wikipedia tags (July 2023)",
  "doi": "10.5281/zenodo.8275697",
  "publication_date": "2023-08-23",
  "description": "&lt;p&gt;Estimation of party positions from Wikipedia tags with Stan (July 2023)&lt;/p&gt;",
  "access_right": "open",
  "creators": [
    {
      "name": "Holger D\u00f6ring",
      "affiliation": "GESIS \u2013 Leibniz Institute for the Social Sciences"
    },
    {
      "name": "Michael Herrmann",
      "affiliation": "University of Konstanz"
    }
  ],
  "related_identifiers": [
    {
      "identifier": "https://github.com/hdigital/partypositions-wikitags/tree/23.07",
      "relation": "isSupplementTo",
      "scheme": "url"
    }
  ],
  "version": "23.07",
  "resource_type": {
    "title": "Software",
    "type": "software"
  },
  "license": {
    "id": "other-open"
  },
  "relations": {
    "version": [
      {
        "index": 1,
        "is_last": false,
        "parent": {
          "pid_type": "recid",
          "pid_value": "7043510"
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
<p>Then, I manually cleaned up the metadata:</p>
<ul>
<li>kept only entries that are not imported automatically</li>
<li>used unicode characters for umlaute</li>
<li>specified license id</li>
</ul>
<div id="0c73168a" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">metadata_json <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb11-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb11-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  "title": "Party positions from Wikipedia tags",</span></span>
<span id="cb11-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  "description": "Estimation of party positions from Wikipedia tags with Stan",</span></span>
<span id="cb11-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  "creators": [</span></span>
<span id="cb11-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    {</span></span>
<span id="cb11-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      "name": "Dring, Holger",</span></span>
<span id="cb11-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      "affiliation": "GESIS  Leibniz Institute for the Social Sciences"</span></span>
<span id="cb11-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    },</span></span>
<span id="cb11-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    {</span></span>
<span id="cb11-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      "name": "Herrmann, Michael",</span></span>
<span id="cb11-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      "affiliation": "University of Konstanz"</span></span>
<span id="cb11-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb11-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  ]</span></span>
<span id="cb11-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb11-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span></code></pre></div>
</div>
<p>Here, I validate the json. Running the cell should not raise an error.</p>
<div id="0c32e208" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">metadata_json <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(metadata_json)</span></code></pre></div>
</div>
<p>Finally, I added it to the GitHub repository  <a href="https://github.com/hdigital/partypositions-wikitags/commit/ac7c4626267f9bf12015db57138d50c119982396">commit ac7c462</a> </p>
<hr>
<p><img src="https://hdigital.github.io/learning-diary/posts/2023-10-31-py-zenodo-api/zenodo-logo.png" class="img-fluid"></p>


</section>

 ]]></description>
  <category>Python</category>
  <category>API</category>
  <guid>https://hdigital.github.io/learning-diary/posts/2023-10-31-py-zenodo-api/</guid>
  <pubDate>Tue, 31 Oct 2023 00:00:00 GMT</pubDate>
  <media:content url="https://hdigital.github.io/learning-diary/posts/2023-10-31-py-zenodo-api/zenodo-logo.png" medium="image" type="image/png" height="52" width="144"/>
</item>
</channel>
</rss>
